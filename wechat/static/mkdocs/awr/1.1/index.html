<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhaibibei">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>十步解析awr报告 - Oracle awr 报告全解析</title>

        <link href="../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-107412137-1', 'zhaibibei.cn');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Oracle awr 报告全解析</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">首页</a>
                </li>
            
            
            
                <li class="active">
                    <a href="./">十步解析awr报告</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Instance Efficiency Percentages <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../2.1/">1.Buffer Nowait</a>
                        </li>
                    
                        <li >
                            <a href="../2.2/">2.Redo NoWait %</a>
                        </li>
                    
                        <li >
                            <a href="../2.3/">3.Buffer Hit %</a>
                        </li>
                    
                        <li >
                            <a href="../2.4/">4.In-memory Sort %</a>
                        </li>
                    
                        <li >
                            <a href="../2.5/">5.Library Hit %</a>
                        </li>
                    
                        <li >
                            <a href="../2.6/">6.Soft Parse %</a>
                        </li>
                    
                        <li >
                            <a href="../2.7/">7.Execute to Parse %</a>
                        </li>
                    
                        <li >
                            <a href="../2.8/">8.Latch Hit %</a>
                        </li>
                    
                        <li >
                            <a href="../2.9/">9.Parse CPU to Parse Elapsd %</a>
                        </li>
                    
                        <li >
                            <a href="../2.10/">10.% Non-Parse CPU</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Oracle  Statistic <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../3.1/">1.Shared Pool Statistic</a>
                        </li>
                    
                        <li >
                            <a href="../3.2/">2.Wait Events Statistics</a>
                        </li>
                    
                        <li >
                            <a href="../3.3/">3.SQL Statistics</a>
                        </li>
                    
                        <li >
                            <a href="../3.4/">4.IO Stats</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Top 5 Timed Events <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../4.1/">1.Top 5 Timed Events</a>
                        </li>
                    
                        <li >
                            <a href="../4.2/">2.db file sequential read等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.3/">3.db file scattered read等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.4/">4.log file sync等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.5/">5.log file parallel write等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.6/">6.log buffer spaces</a>
                        </li>
                    
                        <li >
                            <a href="../4.7/">7.SQL*Net message from dblink</a>
                        </li>
                    
                        <li >
                            <a href="../4.8/">8.SQL*Net message to dblink等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.9/">9.SQL*Net message from client等待事件</a>
                        </li>
                    
                        <li >
                            <a href="../4.10/">10.SQL*Net message to client等待事件</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="..">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../2.1/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#awr">十步解析awr报告</a></li>
        
            <li><a href="#1">1. 数据库细节</a></li>
        
            <li><a href="#2">2. 主机配置信息</a></li>
        
            <li><a href="#3-snapshot">3. SnapShot信息</a></li>
        
            <li><a href="#4-shared-pool-statistics">4. Shared Pool Statistics</a></li>
        
            <li><a href="#5-load-profile">5. Load Profile</a></li>
        
            <li><a href="#6-instance-efficiency-percentages">6. Instance Efficiency Percentages</a></li>
        
            <li><a href="#7-top-10-foreground-events-by-total-wait-time">7. Top 10 Foreground Events by Total Wait Time</a></li>
        
            <li><a href="#8-time-model-statistics">8. Time Model Statistics</a></li>
        
            <li><a href="#9-operating-system-statistics">9. Operating System Statistics</a></li>
        
            <li><a href="#10-sql-statistics">10. SQL Statistics</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="awr">十步解析awr报告</h1>
<p>从这期开始讲解awr报告的部分，首先讲解awr整体的部分</p>
<p>后续会针对不同的点进行讲解</p>
<h2 id="1">1. 数据库细节</h2>
<p><img alt="Alt text" src="../image/1.1/1.png" /></p>
<p>这部分可以看到</p>
<ul>
<li>数据库的版本</li>
<li>数据库 DBID</li>
<li>数据库实例名称及实例号</li>
<li>数据库最近一次启动时间</li>
<li>数据库版本</li>
<li>数据库是否为rac</li>
</ul>
<h2 id="2">2. 主机配置信息</h2>
<p><img alt="Alt text" src="../image/1.1/2.png" /></p>
<p>这部分可以看到</p>
<ul>
<li>数据库主机名</li>
<li>数据库主机平台</li>
<li>服务器CPU及核数</li>
<li>服务器CPU个数</li>
<li>服务器内存大小</li>
</ul>
<h2 id="3-snapshot">3. SnapShot信息</h2>
<p><img alt="Alt text" src="../image/1.1/3.png" /></p>
<p>这部分可以看到</p>
<ul>
<li>awr报告的起止时间以及当时的session数量等</li>
<li>awr报告持续时间</li>
<li>DB 时间</li>
</ul>
<p>DB Time= session time spent in database.</p>
<p>DB Time= CPU Time + Non IDLE wait time.</p>
<p>可以看到DB Time比 Elapsed大，如果大很多并且有性能问题，需再进一步分析，后面章节再说</p>
<h2 id="4-shared-pool-statistics">4. Shared Pool Statistics</h2>
<p>该视图显示的是Shared pool的状态</p>
<p><img alt="Alt text" src="../image/1.1/4.png" /></p>
<p>% SQL with executions&gt;1指的是执行次数大于1的SQL比例，越大越好，如过小则可能是为使用绑定变量导致</p>
<h2 id="5-load-profile">5. Load Profile</h2>
<p>这里我们可以了解系统负载的情况</p>
<p><img alt="Alt text" src="../image/1.1/5.png" /></p>
<p>首先是 <strong>DB CPU(s) per second</strong>，它说明的是每秒钟同时工作的CPU数量</p>
<p>从主机配置可以看到共24个虚拟cpu，而DB CPU(s) per second只有0.4 则说明cpu没有瓶颈</p>
<p>其次我们关注hard parses和 parses的比例，如硬解析率非常高则需要查看cursor_sharing参数和应用程序的绑定变量问题，一般都是由于绑定变量引起的</p>
<h2 id="6-instance-efficiency-percentages">6. Instance Efficiency Percentages</h2>
<p><img alt="Alt text" src="../image/1.1/6.png" /></p>
<p>上面的百分比越高越好，后面会针对每个做介绍</p>
<p>“% Non-Parse CPU” 指的是数据的CPU资源有94.9%用在非解析上，这样是好的</p>
<h2 id="7-top-10-foreground-events-by-total-wait-time">7. Top 10 Foreground Events by Total Wait Time</h2>
<p>这里是排名前十的前台等待事件</p>
<p><img alt="Alt text" src="../image/1.1/7.png" /></p>
<ol>
<li>
<p>首先看wait class栏位，如果是 User I/O , System I/O, Others这种的可以不用太担心，如发现Concurrency这类等待需要特别关心</p>
</li>
<li>
<p>其次看等待时间，wait avg=total wait time(总等待时间)/waits(等待次数),最主要看平均等待时间是否正常</p>
</li>
</ol>
<p>后面章节会详细说明每个等待时间</p>
<h2 id="8-time-model-statistics">8. Time Model Statistics</h2>
<p>该视图说明的是各过程所占的资源比例</p>
<p><img alt="Alt text" src="../image/1.1/8.png" /></p>
<p>我们注意到所有 % of DB Time总和大于100%，因为这是一个累计的比例，下面DB CPU相关的过程包含在DB CPU中</p>
<p>我们需要注意的是一些异常的高占用情况，如hard parse elapsed time (硬解析时间)占用时间过长等</p>
<h2 id="9-operating-system-statistics">9. Operating System Statistics</h2>
<p>该视图是操作系统层面的性能指标</p>
<p><img alt="Alt text" src="../image/1.1/9.png" /></p>
<p>这里需要注意%iowait，他代表CPU在等待io操作完成，这个可能是io过慢或者io操作过多导致。</p>
<h2 id="10-sql-statistics">10. SQL Statistics</h2>
<p><img alt="Alt text" src="../image/1.1/10.png" /></p>
<p>接下来是最重要的一块，他能帮助我们定位占用相关资源的TOP SQL语句</p>
<p><strong>SQL ordered by Elapsed Time</strong></p>
<p><img alt="Alt text" src="../image/1.1/11.png" /></p>
<p>上图为根据持续时间排序的SQL语句</p>
<p>所有栏位可根据字面上意思得出意义</p>
<ul>
<li>如executions过多可能会引起CPU占用率高</li>
<li>如executions低，而elapsed time很高，则需要优化该SQL，降低执行时间</li>
</ul>
<p>需要注意的是execution如果为0不代表未执行，代表在awr报告的持续范围内该语句未执行完成</p>
<p>这里只举持续时间这个例子，其他后面章节详细说明</p>
<p>通过上面的十点应该会对数据库的性能及负载有了大体的了解，接下来会针对内部细节做解释，谢谢。</p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>苏ICP备17053688号</p>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
    </body>
</html>